(function(){function c(a){a&&a.storage&&(this.storage=a.storage);this.async.set=k(this.async.set,this);this.async.get=k(this.async.get,this)}var d=this;window.Promise||console.log("Promise isn't available at this browser");var k=function(a,b){return function(){return a.apply(b,arguments)}};c.prototype.VERSION="0.4.3";var g=c.prototype,h;try{d.localStorage.setItem("___locache___","___locache___"),d.localStorage.getItem("___locache___"),d.localStorage.removeItem("___locache___"),h=!0}catch(p){h=!1}var m=
g.supportsLocalStorage=h,g=c.prototype,f;try{d.sessionStorage.setItem("___locache___","___locache___"),d.sessionStorage.getItem("___locache___"),d.sessionStorage.removeItem("___locache___"),f=!0}catch(q){f=!1}var n=g.supportsSessionStorage=f,l=c.prototype.supportsNativeJSON=!!d.JSON;c.prototype.supportsPostMessage=!!window.postMessage;c.prototype.cachePrefix="___locache___";c.prototype.expirePrefix="___locacheExpire___";c.prototype.backends={local:{set:function(a,b){return d.localStorage.setItem(a,
b)},get:function(a){return d.localStorage.getItem(a)},remove:function(a){return d.localStorage.removeItem(a)},length:function(a){return d.localStorage.length},key:function(a){if(!(0>a||a>=this.length()))return d.localStorage.key(a)},enabled:function(){return l&&m}},session:{set:function(a,b){return d.sessionStorage.setItem(a,b)},get:function(a){return d.sessionStorage.getItem(a)},remove:function(a){return d.sessionStorage.removeItem(a)},length:function(a){return d.sessionStorage.length},key:function(a){if(!(0>
a||a>=this.length()))return d.sessionStorage.key(a)},enabled:function(){return l&&n}}};c.prototype.storage=c.prototype.backends.local;c.prototype.key=function(a){return this.cachePrefix+a};c.prototype.expirekey=function(a){return this.expirePrefix+a};c.prototype.hasExpired=function(a){a=this.expirekey(a);return(a=parseInt(this.storage.get(a),10))&&a<(new Date).getTime()?!0:!1};c.prototype.set=function(a,b,e){if(this.storage.enabled()&&a){var c=this.expirekey(a);a=this.key(a);e?(e*=1E3,this.storage.set(c,
(new Date).getTime()+e)):this.storage.remove(c);b=JSON.stringify(b);return this.storage.set(a,b)}};c.prototype.get=function(a){if(!this.storage.enabled()||!a)return null;if(this.hasExpired(a))return this.remove(this.key(a)),null;a=this.key(a);if(a=this.storage.get(a))try{return JSON.parse(a)}catch(b){return null}return a};c.prototype.async={set:function(a,b,e){return Promise.resolve(this.set(a,b,e))},get:function(a){return Promise.resolve(this.get(a))}};c.prototype.remove=function(a){if(this.storage.enabled()){var b=
this.expirekey(a);a=this.key(a);this.storage.remove(b);this.storage.remove(a)}};c.prototype.incr=function(a){if(this.storage.enabled()){var b=parseInt(this.get(a),10);b||(b=0);b++;this.set(a,b);return b}};c.prototype.decr=function(a){if(this.storage.enabled()){var b=parseInt(this.get(a),10);b||(b=0);b--;this.set(a,b);return b}};c.prototype.setMany=function(a,b){if(this.storage.enabled())for(var e in a)a.hasOwnProperty(e)&&this.set(e,a[e],b)};c.prototype.getMany=function(a){for(var b={},e=0;e<a.length;e++)this.storage.enabled()?
b[a[e]]=this.get(a[e]):b[a[e]]=null;return b};c.prototype.getManyValues=function(a){for(var b=[],e=0;e<a.length;e++)this.storage.enabled()?b.push(this.get(a[e])):b.push(null);return b};c.prototype.removeMany=function(a){if(this.storage.enabled())for(var b=0;b<a.length;b++)this.remove(a[b])};c.prototype.flush=function(){if(this.storage.enabled())for(var a=this.storage.length(),b=this.cachePrefix,a=a-1;0<=a;a--){var e=this.storage.key(a);e&&0===e.indexOf(b)&&(e=e.substring(b.length,e.length),this.remove(e))}};
c.prototype.length=function(){if(!this.storage.enabled())return 0;for(var a=0,b=this.storage.length(),e=this.cachePrefix,c=0;c<b;c++)0===this.storage.key(c).indexOf(e)&&a++;return a};c.prototype.keys=function(){if(!this.storage.enabled())return[];for(var a=[],b=this.storage.length(),c=this.cachePrefix,d=0;d<b;d++){var f=this.storage.key(d);0===f.indexOf(c)&&(f=f.substring(c.length,f.length),a.push(f))}return a};c.prototype.cleanup=function(){if(this.storage.enabled())for(var a=this.storage.length(),
b=this.cachePrefix,c=0;c<a;c++){var d=this.storage.key(c);d&&0===d.indexOf(b)&&(d=d.substring(b.length,d.length),this.hasExpired(d)&&this.remove(d))}};c.prototype.createCache=function(a){return new c(a)};f=new c;f.session=new c({storage:f.backends.session});d.locache=f}).call(this);
